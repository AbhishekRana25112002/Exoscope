{% extends 'base.html' %}
{% load static %}

{% block title %}Exoplanet Detection Analytics{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/astronomy.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid astronomy-container">
    <!-- Hero Section -->
    <div class="hero bg-primary text-white py-5">
        <div class="container">
            <h1 class="display-4 mb-3"><i class="fas fa-satellite"></i> Astronomy Tools</h1>
            <p class="lead">Live satellite tracking and interactive sky maps</p>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top">
        <div class="container">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="#iss-tracker">ISS Tracker</a></li>
                <li class="nav-item"><a class="nav-link" href="#sky-map">Sky Map</a></li>
                <li class="nav-item"><a class="nav-link" href="#planetarium">Planetarium</a></li>
            </ul>
        </div>
    </nav>

    <!-- ISS Tracker Section -->
    <section id="iss-tracker" class="py-5">
        <div class="container">
            <h2 class="section-title"><i class="fas fa-satellite-dish"></i> Live ISS Tracker</h2>
            
            <div class="row">
                <div class="col-md-8">
                    <div class="card tracker-card">
                        <div class="card-header">
                            <i class="fas fa-map-marked-alt"></i> Current ISS Position
                        </div>
                        <div class="card-body">
                            <div id="iss-map" class="astronomy-map"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-info-circle"></i> ISS Information
                        </div>
                        <div class="card-body">
                            <div class="iss-data">
                                <div class="data-item">
                                    <span class="data-label">Latitude:</span>
                                    <span id="iss-lat" class="data-value">Loading...</span>
                                </div>
                                <div class="data-item">
                                    <span class="data-label">Longitude:</span>
                                    <span id="iss-lng" class="data-value">Loading...</span>
                                </div>
                                <div class="data-item">
                                    <span class="data-label">Altitude:</span>
                                    <span id="iss-alt" class="data-value">Loading...</span>
                                </div>
                                <div class="data-item">
                                    <span class="data-label">Velocity:</span>
                                    <span id="iss-vel" class="data-value">Loading...</span>
                                </div>
                                <div class="data-item">
                                    <span class="data-label">Visibility:</span>
                                    <span id="iss-vis" class="data-value">Loading...</span>
                                </div>
                            </div>
                            <hr>
                            <div class="next-passes">
                                <h5><i class="fas fa-clock"></i> Next Passes for Your Location</h5>
                                <div id="iss-passes" class="passes-list">
                                    <div class="text-center py-3">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sky Map Section -->
    <section id="sky-map" class="py-5 bg-light">
        <div class="container">
            <h2 class="section-title"><i class="fas fa-star"></i> Interactive Sky Map</h2>
            
            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <span><i class="fas fa-map"></i> Stellarium Web</span>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary" id="fullscreen-stellarium">
                                        <i class="fas fa-expand"></i> Fullscreen
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div id="stellarium-container" class="sky-map-container">
                                <iframe id="stellarium-iframe" src="https://stellarium-web.org/" 
                                    frameborder="0" allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-cog"></i> Sky Map Controls
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Constellations</label>
                                <select class="form-select" id="constellation-style">
                                    <option value="modern">Modern</option>
                                    <option value="inuit">Inuit</option>
                                    <option value="chinese">Chinese</option>
                                    <option value="egyptian">Egyptian</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">View Mode</label>
                                <select class="form-select" id="view-mode">
                                    <option value="night">Night</option>
                                    <option value="day">Day</option>
                                    <option value="red">Red (Astronomy)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Show</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="show-planets" checked>
                                    <label class="form-check-label" for="show-planets">Planets</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="show-stars" checked>
                                    <label class="form-check-label" for="show-stars">Stars</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="show-grid">
                                    <label class="form-check-label" for="show-grid">Grid</label>
                                </div>
                            </div>
                            <button class="btn btn-primary w-100" id="apply-sky-settings">
                                <i class="fas fa-sync-alt"></i> Apply Settings
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Planetarium Section -->
    <section id="planetarium" class="py-5">
        <div class="container">
            <h2 class="section-title"><i class="fas fa-globe-americas"></i> Solar System Planetarium</h2>
            
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <span><i class="fas fa-solar-panel"></i> Interactive Solar System</span>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary" id="fullscreen-planetarium">
                                        <i class="fas fa-expand"></i> Fullscreen
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div id="planetarium-container" class="sky-map-container">
                                <iframe id="planetarium-iframe" src="https://eyes.nasa.gov/apps/orrery/" 
                                    frameborder="0" allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Leaflet for ISS Map -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

<!-- Custom JS -->
<script src="{% static 'js/astronomy.js' %}"></script>
{% endblock %}